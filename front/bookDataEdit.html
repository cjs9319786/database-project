<!DOCTYPE html>
<html lang="kor">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square-neo.css" rel="stylesheet" />
  <title>도서 편집</title>
  <link rel="stylesheet" href="./css/style.css" />
  <link rel="stylesheet" href="./css/bookDataEdit.css" />
</head>

<body style="background-color: #e0f8de">
  <div id="header">
    <div class="header-bar">
      <div id="logo">
        <img src="./img/logo.png" width="120px" height="100px" onclick="navigateToPage()" style="cursor: pointer" />
      </div>
      <div class="Menu-bar" id="Menu-bar_Member" style="display: none">
        <a class="Menu-item" type="button" href="">도서예약</a>
      </div>
      <div class="Menu-bar" id="Menu-bar_Manager" style="display: block">
        <a class="Menu-item" type="button" href="Member.html">회원관리</a>
        <a class="Menu-item" type="button" href="Main.html">메인화면으로</a>
        <a class="Menu-item" type="button" href="CheckBook.html">도서대출/반납</a>
      </div>
      <div id="login">
        <div id="login_after" style="display: block">
          <button onclick="logout()">Logout</button>
        </div>
      </div>
    </div>
  </div>
  <div id="Main">
    <div class="board_wrap">
      <div class="book_search">
        <img src="./img/search.png" width="70px" height="60px" style="margin-left: 5px" />
        <form id="searchForm" method="POST" action="/search.js">
          <input type="text" id="search_bar" placeholder="도서 제목을 입력하세요" />
          <input id="book_search_btn" type="submit" value="검색" />
        </form>
        <img src="./img/새로고침.png" width="60px" height="45px" onclick="refresh()"
          style="margin-right: 5%; margin-left: 1%; cursor: pointer" />
        <input type="button" id="manage_pub_btn" onclick="openPublisherModal()" value="출판사 관리"
          style="margin-right: 10px; background-color: #555; cursor: pointer; color: white; border: none; padding: 5px 10px; border-radius: 4px;" />
        <input type="button" id="manage_cat_btn" onclick="openCategoryModal()" value="카테고리 관리"
          style="margin-right: 10px; background-color: #555; cursor: pointer; color: white; border: none; padding: 5px 10px; border-radius: 4px;" />
        <input type="button" id="manage_pol_btn" onclick="openPolicyModal()" value="정책 관리"
          style="margin-right: 10px; background-color: #555; cursor: pointer; color: white; border: none; padding: 5px 10px; border-radius: 4px;" />

        <input type="button" id="add_btn" onclick="ModalVisible(true,true)" value="도서 등록" />
      </div>
      <div class="board_list">
        <div class="board" id="board">
          <div class="board_title"></div>
        </div>
      </div>
      <div class="board_page" id="board_page"></div>
    </div>
  </div>
  <section id="book-add-modal-wrap" style="display: none">
    <div class="board-container">
      <div id="board-div">
        <div class="book-title">
          <input id="book_title" type="text" placeholder="도서 제목 (필수)" />
          <p>No.</p>
          <p id="book_num">-</p>
        </div>

        <div class="input_wrap">
          <input id="book_isbn" type="text" placeholder="ISBN (필수)" />
          <select id="book_category">
            <option value="" disabled selected>카테고리 선택 (필수)</option>
          </select>
        </div>

        <div class="input_wrap">
          <input id="book_writer" type="text" placeholder="저자 (선택)" />
          <input id="book_publish" type="text" placeholder="출판사 (필수)" />
        </div>

        <div class="input_wrap">
          <input id="book_amount" type="number" min="1" placeholder="입고 수량 (기본 1권)" />
        </div>

        <input id="book_image" type="text" class="subject-area" placeholder="표지 이미지 URL (http://...)"
          style="height: 40px; margin-bottom: 15px;" />

        <!-- 실물 도서 목록 -->
        <div id="copy_list_area"
          style="display: none; margin-bottom: 15px; border: 1px solid #ccc; padding: 10px; border-radius: 5px; background-color: #fff;">

          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <h4 style="margin: 0;">실물 도서 목록</h4>

            <div id="add_copy_div">
              <input type="number" id="add_copy_amount" placeholder="수량"
                style="width: 60px; height: 30px; padding: 5px; font-size: 14px;" min="1" value="1">
              <button id="btn_add_copy" onclick="addBookCopies()"
                style="height: 30px; padding: 0 10px; cursor: pointer; background-color: #4CAF50; color: white; border: none; border-radius: 4px;">추가</button>
            </div>
          </div>

          <div style="max-height: 150px; overflow-y: auto;">
            <table style="width: 100%; text-align: center; font-size: 14px; border-collapse: collapse;">
              <thead>
                <tr style="border-bottom: 1px solid #ddd; background-color: #f9f9f9;">
                  <th style="padding: 8px;">관리번호</th>
                  <th style="padding: 8px;">상태</th>
                  <th style="padding: 8px;">관리</th>
                </tr>
              </thead>
              <tbody id="copy_list_tbody">
              </tbody>
            </table>
          </div>
        </div>

        <div class="btn-wrap">
          <input id="regist-book" class="modal-btn" type="button" value="등록" />
          <input id="fix-book" class="modal-btn" type="button" value="수정" style="display: none" />
          <input id="exit-modal" class="modal-btn" type="button" value="취소" onclick="ModalVisible(false,false)" />
        </div>
        <div class="btn-wrap">
          <input id="delete-book" class="modal-btn" type="button" value="삭제" />
        </div>
      </div>
    </div>
  </section>
  <script>
    function navigateToPage() {
      window.location.href = "Main.html";
    }
    function logout() {
      localStorage.removeItem("authToken");
      window.location.href = "Main.html";
    }
    function refresh() {
      window.location.href = "bookDataEdit.html";
    }
    // book_modal, ModalVisiable 함수는 bookDataEdit.js에 작성되어 있습니다.
  </script>
  <script src="./js/bookDataEdit.js"></script>
  <!-- 출판사 관리 모달 -->
  <section id="publisher-modal-wrap" style="display: none; z-index: 1100;">
    <div class="board-container" style="height: auto;">
      <div id="board-div" class="modal-content">
        <h2 style="text-align: center; margin-bottom: 20px;">출판사 관리</h2>

        <div style="background: #f9f9f9; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
          <input type="hidden" id="pub_id_hidden">
          <div class="input_wrap" style="margin-bottom: 10px;">
            <input id="input_pub_name" type="text" placeholder="출판사 이름 (필수)" style="width: 48%;">
            <input id="input_pub_phone" type="text" placeholder="전화번호 (선택)" style="width: 48%;">
          </div>
          <div style="text-align: right;">
            <button id="btn_reset_pub" onclick="resetPubForm()"
              style="background: #ccc; border:none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">초기화</button>
            <button id="btn_save_pub" onclick="savePublisher()"
              style="background: #4CAF50; color: white; border:none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">등록</button>
          </div>
        </div>

        <div style="display: flex; justify-content: flex-end; margin-bottom: 10px; align-items: center;">
          <input type="text" id="pub_search_input" placeholder="출판사명 검색"
            style="height: 35px; width: 200px; padding: 5px; border: 1px solid #ccc; border-radius: 4px; margin-right: 5px;"
            onkeyup="if(window.event.keyCode==13){searchPublishers()}"> <button onclick="searchPublishers()"
            style="height: 35px; padding: 0 15px; background-color: #333; color: white; border: none; border-radius: 4px; cursor: pointer;">
            검색
          </button>
        </div>

        <div style="height: 350px; overflow-y: auto; border: 1px solid #ddd;">
          <table style="width: 100%; text-align: center; border-collapse: collapse;">
            <thead style="position: sticky; top: 0; background: #eee;">
              <tr>
                <th style="padding: 10px; width: 40%;">이름</th>
                <th style="padding: 10px; width: 30%;">전화번호</th>
                <th style="padding: 10px; width: 30%;">관리</th>
              </tr>
            </thead>
            <tbody id="publisher_list_tbody"></tbody>
          </table>
        </div>

        <div id="pub_pagination" class="board_page" style="margin-top: 10px; border-top: none; height: auto;">
        </div>

        <div class="btn-wrap" style="margin-top: 10px;">
          <input class="modal-btn" type="button" value="닫기" onclick="closePublisherModal()" />
        </div>
      </div>
    </div>
  </section>
  <script src="./js/publisherDataEdit.js"></script>

  <section id="category-modal-wrap" style="display: none; z-index: 1100;">
    <div class="board-container" style="height: auto;">
      <div id="board-div" class="modal-content">
        <h2 style="text-align: center; margin-bottom: 20px;">카테고리 관리</h2>

        <div style="background: #f9f9f9; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
          <div class="input_wrap" style="margin-bottom: 10px;">
            <input id="input_cat_id" type="number" placeholder="ID 번호 (필수)" style="width: 30%;">
            <input id="input_cat_name" type="text" placeholder="카테고리 이름 (필수)" style="width: 65%;">
          </div>

          <div style="text-align: right;">
            <button onclick="resetCatForm()"
              style="background: #ccc; border:none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">초기화</button>
            <button onclick="saveCategory()"
              style="background: #4CAF50; color: white; border:none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">등록</button>
          </div>
        </div>

        <div style="height: 350px; overflow-y: auto; border: 1px solid #ddd;">
          <table style="width: 100%; text-align: center; border-collapse: collapse;">
            <thead style="position: sticky; top: 0; background: #eee;">
              <tr>
                <th style="padding: 10px; width: 20%;">ID</th>
                <th style="padding: 10px; width: 50%;">이름</th>
                <th style="padding: 10px; width: 30%;">관리</th>
              </tr>
            </thead>
            <tbody id="category_list_tbody"></tbody>
          </table>
        </div>

        <div id="cat_pagination" class="board_page" style="margin-top: 10px; border-top: none; height: auto;">
        </div>

        <div class="btn-wrap" style="margin-top: 10px;">
          <input class="modal-btn" type="button" value="닫기" onclick="closeCategoryModal()" />
        </div>
      </div>
    </div>
  </section>
  <script src="./js/categoryDataEdit.js"></script>

  <div id="policy-modal-wrap" class="modal-overlay"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000; justify-content: center; align-items: center;">

    <div class="modal-content"
      style="background: white; padding: 30px; border-radius: 10px; width: 400px; position: relative; margin: 10% auto;">

      <h2
        style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #9c27b0; padding-bottom: 10px; color: #9c27b0;">
        운영 정책 설정</h2>

      <div style="display: flex; flex-direction: column; gap: 15px;">

        <div style="display: flex; justify-content: space-between; align-items: center;">
          <label style="font-weight: bold;">최대 대여 권수 (권)</label>
          <input type="number" id="policy_max_borrow" style="padding: 5px; width: 100px; text-align: right;">
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center;">
          <label style="font-weight: bold;">기본 대여 기간 (일)</label>
          <input type="number" id="policy_due_days" style="padding: 5px; width: 100px; text-align: right;">
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center;">
          <label style="font-weight: bold;">연장 가능 기간 (일)</label>
          <input type="number" id="policy_extend_days" style="padding: 5px; width: 100px; text-align: right;">
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center;">
          <label style="font-weight: bold;">연체 패널티 (일)</label>
          <input type="number" id="policy_penalty_days" style="padding: 5px; width: 100px; text-align: right;">
        </div>

      </div>

      <div style="margin-top: 30px; text-align: center; display: flex; justify-content: space-between;">
        <button onclick="closePolicyModal()"
          style="width: 48%; padding: 10px; background: #ccc; border: none; border-radius: 5px; cursor: pointer; color: black; font-weight: bold;">닫기</button>
        <button onclick="savePolicy()"
          style="width: 48%; padding: 10px; background: #9c27b0; border: none; border-radius: 5px; cursor: pointer; color: white; font-weight: bold;">저장</button>
      </div>

    </div>
  </div>
  <script src="./js/policyDataEdit.js"></script>
</body>

</html>
